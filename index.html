<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Snake Game</title>
<style>
  body { display: flex; justify-content: center; align-items: center; height: 100vh; color: #fff; font-family: sans-serif; flex-direction: column; margin:0; background: #222; }
  canvas { background: #000; }
  #score { margin-bottom: 10px; font-size: 20px; }
  #message { margin-top: 10px; font-size: 24px; color: yellow; }
</style>
</head>
<body>
<div id="score">Score: 0 | Level: 1</div>
<canvas id="game" width="400" height="400"></canvas>
<div id="message"></div>

<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
const scoreDisplay = document.getElementById('score');
const messageDisplay = document.getElementById('message');

const grid = 20;
let speed = 6;
let count = 0;
let snake = [{x: 160, y: 160}];
let dx = grid;
let dy = 0;
let food = {x: 0, y: 0};
let score = 0;
let level = 1;
let highScore = 0;
let gameOver = false;

function getRandomFood() {
    food.x = Math.floor(Math.random() * canvas.width / grid) * grid;
    food.y = Math.floor(Math.random() * canvas.height / grid) * grid;
}
getRandomFood();

function updateBackground() {
    const colors = ['#fff', '#eee', '#ddd', '#ccc', '#bbb', '#aaa', '#999', '#888'];
    const index = Math.min(level-1, colors.length-1);
    canvas.style.background = colors[index];
}

function resetGame() {
    snake = [{x: 160, y: 160}];
    dx = grid; dy = 0;
    score = 0;
    level = 1;
    speed = 6;
    gameOver = false;
    messageDisplay.textContent = '';
    scoreDisplay.textContent = `Score: 0 | Level: 1 | High Score: ${highScore}`;
    updateBackground();
    getRandomFood();
}

function gameLoop() {
    requestAnimationFrame(gameLoop);
    if (gameOver) return;
    if (++count < speed) return;
    count = 0;

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    let head = {x: snake[0].x + dx, y: snake[0].y + dy};
    snake.unshift(head);

    if (head.x === food.x && head.y === food.y) {
        score += 10;
        if (score > highScore) {
        highScore = score;
        localStorage.setItem('highScore', highScore);
        }

        if (score % 50 === 0) {
            level++;
            updateBackground();
            if (speed > 2) speed--;
        }
        scoreDisplay.textContent = `Score: ${score} | Level: ${level} | High Score: ${highScore}`;
        getRandomFood();
    } else {
        snake.pop();
    }
    ctx.fillStyle = 'red';
    ctx.beginPath();
    ctx.arc(food.x + grid/2, food.y + grid/2, grid/2, 0, Math.PI * 2);
    ctx.fill();


    ctx.fillStyle = 'lime';
    snake.forEach(seg => ctx.fillRect(seg.x, seg.y, grid-1, grid-1));

    if (head.x < 0 || head.x >= canvas.width || head.y < 0 || head.y >= canvas.height ||
        snake.slice(1).some(seg => seg.x === head.x && seg.y === head.y)) {
        gameOver = true;
        messageDisplay.textContent = `GAME OVER! Score: ${score}, Level: ${level}. High Score: ${highScore}. Press R to restart.`;
    }
}

document.addEventListener('keydown', e => {
    if (!gameOver) {
        if (e.key === 'ArrowLeft' && dx === 0) { dx = -grid; dy = 0; }
        else if (e.key === 'ArrowUp' && dy === 0) { dx = 0; dy = -grid; }
        else if (e.key === 'ArrowRight' && dx === 0) { dx = grid; dy = 0; }
        else if (e.key === 'ArrowDown' && dy === 0) { dx = 0; dy = grid; }
    }
    if (gameOver && (e.key === 'r' || e.key === 'R')) {
        resetGame();
    }
});

updateBackground();
requestAnimationFrame(gameLoop);
</script>
</body>
</html>
